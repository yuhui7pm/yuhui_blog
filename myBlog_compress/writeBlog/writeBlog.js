var base64head="";function post(url,data={}){return $.ajax({type:'post',url,data:JSON.stringify(data),contentType:"application/json"})}window.onload=()=>{$textTitle=$('#text-title');$textContent=$('#text-content');$btnCreate=$('#btn-create');$('#summernote').summernote({placeholder:'请输入公告内容',height:400,width:720});commentsAdaption();$("#headPortraitUpload").on("change",headPortraitListener);$btnCreate.click(()=>{var sHTML=$('.note-editable').html();const title=$textTitle.val().trim();const introduction=$textContent.val().trim();const classification=$('#state_list option:selected').text();$.ajax({url:'/api/blog/new',type:'post',dataType:'json',contentType:"application/json",data:JSON.stringify({title,classification,base64head,introduction,sHTML}),success:(data)=>{if(data.errNum==0){window.location.href='/index.html'}}})})}function setHeight(element){$(element).css({'height':'auto','overflow-y':'hidden'}).height(element.scrollHeight)}function commentsAdaption(){$('textarea').each(()=>{setHeight(this)}).on('input',function(){setHeight(this)})}function headPortraitListener(e){var img=document.getElementById('headPortraitImgShow');if(window.FileReader){var file=e.target.files[0];var reader=new FileReader();if(file&&file.type.match('image.*')){reader.readAsDataURL(file)}else{}reader.onloadend=function(e){img.setAttribute('src',reader.result);$(img).css('margin-top','-20px');base64head=reader.result}}}